{% load static %} 
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Market Microstructure{% endblock %}</title>
    
    <link rel="stylesheet" href="{% static 'css/main_dashboard.css' %}">
    {% block extra_css %}{% endblock %}
</head>
<body>
    {% if user.is_authenticated %}
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <div class="logo-icon">FS</div>
                    <span>FutureSight</span>
                </div>
                <div class="version">v2.4.1 Connected</div>
            </div>
            <nav class="sidebar-nav">
                <a href="{% url 'dashboard:overview' %}" class="nav-item {% if request.resolver_match.app_name == 'dashboard' %}active{% endif %}">
                    <span class="nav-icon">ğŸ“Š</span>
                    <span>Dashboard</span>
                </a>
                <a href="{% url 'forecast:index' %}" class="nav-item {% if request.resolver_match.app_name == 'forecast' %}active{% endif %}">
                    <span class="nav-icon">ğŸ”®</span>
                    <span>Forecast</span>
                </a>
                <a href="{% url 'patterns:live' %}" class="nav-item {% if request.resolver_match.app_name == 'patterns' %}active{% endif %}">
                    <span class="nav-icon">ğŸ“ˆ</span>
                    <span>Patterns</span>
                </a>
                <a href="{% url 'accounts:profile' %}" class="nav-item {% if request.resolver_match.app_name == 'accounts' %}active{% endif %}">
                    <span class="nav-icon">âš™ï¸</span>
                    <span>Settings</span>
                </a>
            </nav>
            <div class="sidebar-footer">
                <div class="user-profile">
                    <div class="user-avatar">{{ user.first_name.0|default:user.username.0|upper }}</div>
                    <div class="user-info">
                        <div class="user-name">{{ user.get_full_name|default:user.username }}</div>
                        <div class="user-plan">{% if user.profile %}{{ user.profile.plan|title }} Plan{% else %}Free Plan{% endif %}</div>
                        <div class="usage-bar">
                            <div class="usage-fill" data-usage="{{ user.profile.usage_percentage|default_if_none:0 }}"></div>
                        </div>
                        <div class="usage-text">{% if user.profile %}{{ user.profile.usage_percentage|floatformat:0 }}{% else %}0{% endif %}% Usage</div>
                    </div>
                </div>
            </div>
        </aside>
        <main class="main-content">
            {% block content %}{% endblock %}
        </main>
    </div>
    {% else %}
        {% block auth_content %}{% endblock %}
    {% endif %}
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="{% static 'js/main.js' %}"></script>
    {% block extra_js %}{% endblock %}
</body>
</html>                                                     